<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>월간 스케줄</title>
    <style>
      @font-face {
        font-family: "Eagles-Bold";
        src: url("Fonts/HanwhaEagles-Regular.ttf") format("truetype");
      }
      @font-face {
        font-family: "Eagles-Gothic";
        src: url("Fonts/06HANWHAGOTHICL.TTF") format("truetype");
      }
      @font-face {
        font-family: "NotoSansJP-Bold";
        src: url("Fonts/NotoSansJP-Bold.ttf") format("truetype");
      }

      body {
        background-color: #f8f9fa;
        font-family: "Eagles-Gothic", sans-serif;
        padding: 0;
        margin: 0;
      }

      .sticky-header {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: rgb(217, 217, 217);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }
      .top-nav-bar {
        display: flex;
        max-width: 1400px;
        margin: 0 auto;
        padding: 10px 10px 5px 10px;
        gap: 10px;
      }
      .top-nav-btn {
        flex: 1;
        text-decoration: none;
        padding: 10px 0;
        border-radius: 6px;
        text-align: center;
        font-family: "Eagles-Bold";
        font-size: 3rem;
        color: white;
        transition: all 0.2s;
      }
      .btn-futures {
        background-color: rgb(252, 78, 0);
      }
      .btn-dev {
        background-color: rgb(28, 30, 60);
      }
      .top-nav-btn:hover {
        filter: brightness(1.2);
        transform: scale(1.01);
      }

      .days-header {
        display: flex;
        max-width: 1400px;
        margin: 0 auto;
        color: rgb(0, 0, 0);
        padding-left: 35px;
        font-family: "NotoSansJP-Bold";
        text-align: center;
      }
      .header-slot {
        flex: 1;
        padding: 12px 0;
        border-right: 1px solid rgb(217, 217, 217);
        font-size: 1.3rem;
      }

      .container {
        max-width: 1400px;
        margin: 20px auto;
        padding: 0 10px;
      }
      .week-block {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        margin-bottom: 25px;
        border: 1px solid #ddd;
        overflow: hidden;
      }

      .team-row {
        display: flex;
        border-bottom: 1px solid #eee;
        min-height: 30px;
        position: relative;
      }
      .team-label {
        width: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Eagles-Bold";
        color: white;
        flex-shrink: 0;
        font-size: 1.9rem;
        z-index: 20;
      }
      .futures-row {
        background-color: rgb(254, 231, 228);
        
      }
      .futures-label {
        background-color: rgb(252, 78, 0);
      }

      /* 육성군 행 높이 축소 */
      .dev-row {
        background-color: rgb(230, 230, 255);
        min-height: 60px !important;
      }
      .dev-label {
        background-color: rgb(28, 30, 60);
      }

      .day-slots {
        display: flex;
        flex-grow: 1;
        width: calc(100% - 35px);
        align-items: stretch;
      }

      /* 기본 칸 높이 (퓨처스 기준) */
      .day-slot {
        flex: 1;
        border-right: 1px solid hsla(0, 0%, 0%, 0.1);
        padding: 12px 10px;
        min-width: 0;
        position: relative;
        height: 82px;
        overflow: hidden;
        cursor: pointer;
        transition: background 0.2s;
      }

      /* [중요] 육성군 전용 칸 높이 강제 적용 */
      .dev-row .day-slot {
        height: 51px !important;
        padding: 8px 10px;
      }

      .day-slot:hover {
        background-color: rgba(0, 0, 0, 0.03);
      }
      .day-slot.today {
        background-color: rgba(255, 255, 255, 0.7);
        outline: 2px solid #ff6600;
        outline-offset: -2px;
      }

      .date-label {
        font-size: 1.5rem;
        color: #474747;
        font-weight: bold;
        margin-bottom: 8px;
        text-align: center;
        display: block;
      }
      .event-content {
        text-align: center;
        margin-bottom: 12px;
      }
      .event-title,
      .event-info,
      .event-desc {
        display: block;
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        width: 100%;
      }
      .event-title {
        font-weight: 800;
        font-size: 1.54rem;
        margin-bottom: 2px;
      }
      .event-info {
        font-weight: 600;
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 2px;
      }
      .event-desc {
        font-size: 1.1rem;
        opacity: 0.75;
        border-top: 1px dashed rgba(0, 0, 0, 0.1);
        padding-top: 3px;
        margin-bottom: 10px;
      }

      /* 모달 스타일 */
      #modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        backdrop-filter: blur(8px);
      }
      #modal-content {
        background: white;
        width: 70vw;
        height: 70vh;
        border-radius: 24px;
        padding: 40px;
        box-sizing: border-box;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.6);
      }

      #modal-content .event-content {
        width: 100%;
        padding: 30px 0;
        border-bottom: 2px solid #eee;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      #modal-content .event-content:last-child {
        border-bottom: none;
      }
      #modal-content .event-title,
      #modal-content .event-info,
      #modal-content .event-desc {
        white-space: normal;
        overflow: visible;
        line-height: 1.3;
        text-align: center;
      }
      #modal-content .event-title {
        font-size: 3rem;
        margin-bottom: 15px;
      }
      #modal-content .event-info {
        font-size: 2.2rem;
        margin-bottom: 15px;
      }
      #modal-content .event-desc {
        font-family: "NotoSansJP-Bold", sans-serif;
        font-size: 1.8rem;
        border-top: 2px dashed rgba(0, 0, 0, 0.1);
        padding-top: 20px;
        width: 85%;
        white-space: pre-wrap;
        word-break: break-word;
      }

      /* 색상 테마 */
      .text-orange {
        color: rgb(252, 78, 0) !important;
      }
      .text-navy {
        color: rgb(23, 35, 207) !important;
      }
      .text-green {
        color: rgb(140, 210, 70) !important;
      }
      .text-blue {
        color: rgb(0, 190, 210) !important;
      }
      .text-red {
        color: rgb(255, 0, 0) !important;
      }

      .day-slot.has-overflow::after {
        content: "●●●";
        position: absolute;
        bottom: 3px;
        width: 100%;
        text-align: center;
        font-size: 8px;
        color: rgba(0, 0, 0, 0.2);
        letter-spacing: 2px;
      }

      /* 타이틀과 로고를 한 줄에 정렬 */
.title-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  margin-bottom: 2px;
}

.team-logo-small {
  width: 22px;  /* 표 크기에 맞춰 조절하세요 */
  height: 22px;
  object-fit: contain;
  /* 인쇄 시에도 로고가 잘 나오도록 설정 */
  -webkit-print-color-adjust: exact;
}

/* 인쇄 시 로고 크기 미세 조정 */
@media print {
  .team-logo-small {
    width: 18px;
    height: 18px;
  }
}

#print-title {
  display: block; /* 평상시에도 화면 상단에 보이도록 설정 (원치 않으시면 none으로) */
  text-align: center;
  font-family: "Eagles-Bold", sans-serif;
  font-size: 3.5rem;   /* 아주 큼직한 타이틀 크기 */
  color: #1c1e3c;      /* 이글스 네이비 색상 */
  padding: 20px 0;     /* 상하 여백을 넉넉히 주어 공간 확보 */
  letter-spacing: 2px; /* 글자 간격을 넓혀 고급스럽게 */
  border-bottom: 5px solid rgb(252, 78, 0); /* 하단에 한화 오렌지 포인트 라인 */
  max-width: 1400px;
  margin: 0 auto 30px auto;
  transition: all 0.3s ease;
}

#print-title:hover {
  opacity: 0.7;        /* 살짝 투명하게 */
  transform: scale(1.01); /* 아주 미세하게 커짐 */
}

/* 인쇄할 때는 클릭하는 느낌(커서 등)이 안 나오도록 설정 */
@media print {
  #print-title {
    cursor: default !important;
    transform: none !important;
  }

}

@media print {
  /* 인쇄 시 오늘 날짜 강조(테두리, 배경색) 제거 */
  .day-slot.today {
    outline: none !important;
    background-color: transparent !important;
    outline-offset: 0 !important;
  }
}
  
  /* 인쇄 시 컨테이너와 제목 사이 간격 */
  .container {
    margin-top: 5px !important;
  }
}

      <style>
  /* ... 기존 스타일 유지 ... */

  /* [추가] 인쇄용 제목 스타일 (평소엔 숨김) */
  #print-title {
    display: none;
    text-align: center;
    font-family: "Eagles-Bold";
    font-size: 24pt;
    margin-bottom: 20px;
    color: #000;
  }

  /* 세로 한 장 압축 인쇄 설정 */
  @media print {
    @page {
      size: A4 portrait; /* 세로 방향 */
      margin: 0.5cm;     /* 여백 최소화 */
    }

    /* 1. 인쇄 제목 표시 */
    #print-title { display: block !important; }

    /* 2. 불필요한 요소 제거 */
    .sticky-header, .top-nav-bar, #modal-overlay, .day-slot::after {
      display: none !important;
    }

    /* 3. 전체 레이아웃 압축 */
    body { background: white !important; }
    .container { max-width: 100% !important; width: 100% !important; margin: 0 !important; }
    
    .week-block {
      margin-bottom: 5px !important; /* 주차 간격 최소화 */
      page-break-inside: avoid;
      border: 1px solid #000 !important;
    }

    /* 4. 높이 강제 축소 (한 장에 넣기 위함) */
    .team-row { min-height: auto !important; }
    .day-slot { 
      height: 60px !important;  /* 퓨처스 높이 축소 */
      padding: 2px !important; 
    }
    .dev-row .day-slot { 
      height: 40px !important;  /* 육성군 높이 더 축소 */
    }

    /* 5. 폰트 크기 대폭 축소 (압축용) */
    .date-label { font-size: 1rem !important; margin-bottom: 2px !important; }
    .event-title { font-size: 0.85rem !important; white-space: normal !important; }
    .event-info { font-size: 0.75rem !important; }
    .event-desc { display: none !important; } /* 인쇄 시 상세설명은 생략 (공간 확보) */

    .team-label { width: 25px !important; font-size: 1.2rem !important; }
    .header-slot { font-size: 1.5rem !important; padding: 5px 0 !important; }

    /* 배경색 출력 보장 */
    * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
  }


 /* 날짜와 로고 컨테이너 */
.date-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;           /* 간격을 살짝 좁혀 한 줄 유지 유도 */
  margin-bottom: 8px;
  width: 100%;
  flex-wrap: nowrap;  /* 로고와 날짜가 절대 줄바꿈되지 않도록 설정 */
}

/* 날짜 라벨 (M/D (요일) 한 줄 유지) */
.date-label {
  margin-bottom: 0 !important;
  font-family: "NotoSansJP-Bold", sans-serif;
  font-size: 1rem;
  white-space: nowrap; /* 텍스트 내 줄바꿈 강제 방지 */
  flex-shrink: 0;      /* 공간이 좁아도 글자가 찌그러지지 않게 함 */
}

/* 날짜 옆 로고 크기 */
.date-side-logo {
  width: 25px;         /* 한 줄 유지를 위해 크기를 살짝 조절 */
  height: 25px;
  object-fit: contain;
  flex-shrink: 0;
}

/* 인쇄 시 로고 크기 미세 조정 */
@media print {
  .date-side-logo {
    width: 20px;
    height: 20px;
  }
}
</style>

<body>
  <div id="print-title" onclick="location.href='index.html'" style="cursor: pointer;">
  퓨처스/육성군 일정표 ~(다음 6주)
</div>
  <div id="modal-overlay" onclick="closeModal()">
    <div id="modal-content" onclick="event.stopPropagation()"></div>
  </div>
    </style>
  </head>
  <body>
    <div id="modal-overlay" onclick="closeModal()">
      <div id="modal-content" onclick="event.stopPropagation()"></div>
    </div>

    <div class="sticky-header">
      <div class="top-nav-bar">
        <a href="futures.html" class="top-nav-btn btn-futures">퓨처스 스케줄</a>
        <a href="development.html" class="top-nav-btn btn-dev">육성군 스케줄</a>
      </div>
      <div class="days-header">
        <div class="header-slot" style="color: #ff0019">日</div>
        <div class="header-slot">月</div>
        <div class="header-slot">火</div>
        <div class="header-slot">水</div>
        <div class="header-slot">木</div>
        <div class="header-slot">金</div>
        <div class="header-slot" style="color: #2010ff">土</div>
      </div>
    </div>

    <div class="container" id="schedule-container">
      <div
        id="loading"
        style="
          text-align: center;
          padding: 50px;
          font-family: &quot;Eagles-Bold&quot;;
          color: #ff6600;
        "
      >
        데이터 로딩 중...
      </div>
    </div>

    <script>
      const API_KEY = "AIzaSyAluwiwfHMYHBoAZe5EAXAiejet-s_Pwl8";
      const CALENDARS = [
        {
          id: "0e62092f3ac04d780ab1cccccb428e2119f2823be6f59112cc0e427d843a0695@group.calendar.google.com",
          name: "F",
          rowClass: "futures-row",
          labelClass: "futures-label",
        },
        {
          id: "ca9502e51d0b0bd07eaa8ab7dbbc3925b69576439b0642b072dc79015eed8d11@group.calendar.google.com",
          name: "D",
          rowClass: "dev-row",
          labelClass: "dev-label",
        },
      ];

      function openModal(slotId) {
        const slot = document.getElementById(slotId);
        const content = slot.querySelector(".slot-content").innerHTML;
        if (!content.trim()) return;
        const modalContent = document.getElementById("modal-content");
        modalContent.innerHTML = content;
        document.getElementById("modal-overlay").style.display = "flex";
        document.body.style.overflow = "hidden";
      }

      function closeModal() {
        document.getElementById("modal-overlay").style.display = "none";
        document.body.style.overflow = "auto";
      }

      function formatTime(dateTimeStr) {
        if (!dateTimeStr) return "";
        const date = new Date(dateTimeStr);
        return `${String(date.getHours()).padStart(2, "0")}:${String(date.getMinutes()).padStart(2, "0")}`;
      }



      
      async function fetchEvents(calId, start, days) {
        const end = new Date(start);
        end.setDate(start.getDate() + days);
        const url = `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(calId)}/events?key=${API_KEY}&timeMin=${start.toISOString()}&timeMax=${end.toISOString()}&singleEvents=true&orderBy=startTime`;
        try {
          const response = await fetch(url);
          const data = await response.json();
          return data.items || [];
        } catch (e) {
          return [];
        }
      }

      function getConditionClass(text) {
        if (text.includes("휴")) return "text-red";
        if (text.includes("-한화")) return "text-orange";
        if (text.includes("한화-")) return "text-navy";
        if (text.includes("미정")) return "text-green";
        if (text.includes("이동")) return "text-blue";
        return "";
      }

      async function renderSchedule() {
  const d = new Date();
  const diff = d.getDate() - d.getDay();
  const baseSunday = new Date(d.setDate(diff));
  baseSunday.setHours(0, 0, 0, 0);

  const container = document.getElementById("schedule-container");
  const [futures, dev] = await Promise.all([
    fetchEvents(CALENDARS[0].id, baseSunday, 42),
    fetchEvents(CALENDARS[1].id, baseSunday, 42),
  ]);

  container.innerHTML = "";
  const weekDays = ["일", "월", "화", "수", "목", "금", "토"]; // 요일 배열 추가

  for (let w = 0; w < 6; w++) {
    const weekStart = new Date(baseSunday);
    weekStart.setDate(baseSunday.getDate() + w * 7);
    const weekBlock = document.createElement("div");
    weekBlock.className = "week-block";

    [futures, dev].forEach((events, idx) => {
      const cal = CALENDARS[idx];
      const row = document.createElement("div");
      row.className = `team-row ${cal.rowClass}`;
      let rowHtml = `<div class="team-label ${cal.labelClass}">${cal.name}</div><div class="day-slots">`;

      for (let i = 0; i < 7; i++) {
        const currentDay = new Date(weekStart);
        currentDay.setDate(weekStart.getDate() + i);
        const slotId = `slot-${idx}-${w}-${i}`;
        const isToday = currentDay.toDateString() === new Date().toDateString() ? "today" : "";
        
        const dayEvents = events.filter(
          (e) => new Date(e.start.date || e.start.dateTime).toDateString() === currentDay.toDateString()
        );

        // --- [날짜 양옆 로고 추출 로직] ---
        let leftLogoHtml = "";
        let rightLogoHtml = "";
        
        // 해당 날짜에 이벤트가 있고, 첫 번째 이벤트 제목에 '-'가 있을 때만 로고 생성
        if (dayEvents.length > 0 && dayEvents[0].summary.includes("-")) {
          const teams = dayEvents[0].summary.split("-");
          const leftTeam = teams[0].trim();
          const rightTeam = teams[1].trim().split(" ")[0]; // [P] 등 부가정보 제거

          leftLogoHtml = `<img src="teams/${leftTeam}.png" class="date-side-logo" onerror="this.style.display='none'">`;
          rightLogoHtml = `<img src="teams/${rightTeam}.png" class="date-side-logo" onerror="this.style.display='none'">`;
        }

        // 요일 계산
        const dayLabel = weekDays[currentDay.getDay()];
        
        // 날짜 라벨 HTML (퓨처스 행인 idx === 0일 때만 로고와 함께 출력)
        const dateLabelHtml = idx === 0 
          ? `<div class="date-wrapper">
               ${leftLogoHtml}
               <span class="date-label">${currentDay.getMonth() + 1}/${currentDay.getDate()} (${dayLabel})</span>
               ${rightLogoHtml}
             </div>` 
          : "";

        rowHtml += `<div class="day-slot ${isToday}" id="${slotId}" onclick="openModal('${slotId}')">
                      ${dateLabelHtml}
                      <div class="slot-content">`;

        dayEvents.forEach((e) => {
          const titleText = e.summary || "";
          const startTime = formatTime(e.start.dateTime);
          const infoText = (e.location || "") + (startTime ? ` [${startTime}]` : "");
          const cClass = getConditionClass(titleText);
          
          // 이벤트 타이틀에는 로고 없이 텍스트만 출력
          rowHtml += `<div class="event-content ${cClass}">
                        <span class="event-title">${titleText}</span>
                        ${infoText ? `<span class="event-info">${infoText}</span>` : ""}
                        ${e.description ? `<span class="event-desc">${e.description}</span>` : ""}
                      </div>`;
        });
        rowHtml += `</div></div>`;
      }
      rowHtml += `</div>`;
      row.innerHTML = rowHtml;
      weekBlock.appendChild(row);

      // (기존 setTimeout 생략 - 도트 표시 로직 유지)
    });
    container.appendChild(weekBlock);
  }
}
      renderSchedule();
    </script>
  </body>
</html>
