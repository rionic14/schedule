<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>K ìŠ¤ì¼€ì¤„ - í•œí™”ì´ê¸€ìŠ¤ ì—ë””ì…˜</title>
    <style>
      /* 1. í°íŠ¸ ë“±ë¡ */
      @font-face {
        font-family: "Eagles-Bold";
        src: url("Fonts/HanwhaEagles-Regular.ttf") format("truetype");
        font-weight: normal;
      }
      @font-face {
        font-family: "Eagles-Gothic";
        src: url("Fonts/06HANWHAGOTHICL.TTF") format("truetype");
        font-weight: normal;
      }

      /* 2. ì „ì²´ ë ˆì´ì•„ì›ƒ */
      body {
        margin: 0;
        padding: 8px;
        background-color: #f5f5f7;
        font-family: "Eagles-Gothic", sans-serif;
        -webkit-font-smoothing: antialiased;
        position: relative; /* ìœ ë‹ˆí¼ ë°°ì¹˜ë¥¼ ìœ„í•´ ì¶”ê°€ */
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        position: relative;
      }

      /* 3. ìš°ì¸¡ ìƒë‹¨ ìœ ë‹ˆí¼ ì‚¬ì§„ ì»¨í…Œì´ë„ˆ */
      .uniform-container {
        position: absolute;
        top: 0px;
        right: 10px;
        z-index: 100;
        display: flex; /* ê°€ë¡œ ì •ë ¬ì„ ìœ„í•œ ì„¤ì • */
        align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
        gap: 15px; /* í…ìŠ¤íŠ¸ì™€ ì‚¬ì§„ ì‚¬ì´ ê°„ê²© */
      }

      /* ìœ ë‹ˆí¼ íƒ€ì´í‹€ ìŠ¤íƒ€ì¼ */
      .uniform-title {
        font-family: "Eagles-Bold", sans-serif;
        font-size: 1.8rem;
        color: rgb(28, 30, 60);
        border-left: 4px solid rgb(28, 30, 60);
        /* 3. ìœ„ìª½ paddingì„ 0ìœ¼ë¡œ ì£¼ë©´ ê¸€ìê°€ ë” ìœ„ë¡œ ë¶™ìŠµë‹ˆë‹¤ */
        padding: 0px 0px 0px 10px;
        background-color: rgba(255, 255, 255, 0.5);
        white-space: nowrap;
        line-height: 1; /* 4. ì¤„ê°„ê²©ì„ ìµœì†Œí™”í•´ì„œ ìœ„ ê³µê°„ ì‚­ì œ */
      }

      /* ìœ ë‹ˆí¼ ì´ë¯¸ì§€ í¬ê¸° ë° íš¨ê³¼ */
      #uniform-img {
        width: 130px; /* ì›í•˜ëŠ” í¬ê¸°ë¡œ ì¡°ì ˆí•˜ì„¸ìš” */
        height: auto;
        display: none;
        filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.15));
      }

      /* 4. ìƒë‹¨ í—¤ë” ì»¨í…Œì´ë„ˆ */
      .schedule-header-container {
        margin-bottom: 15px;
        padding: 5px 5px;
        border-left: 6px solid rgb(28, 30, 60);
      }

      .main-title {
        font-family: "Eagles-Bold", sans-serif;
        font-size: 2.8rem;
        color: rgb(28, 30, 60);
        margin: 0;
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      /* 5. ê°±ì‹  ë²„íŠ¼ ìŠ¤íƒ€ì¼ (í¬ê²Œ ìˆ˜ì •ë¨) */
      .status-btn {
        cursor: pointer;
        border: none;
        border-radius: 50px;
        padding: 8px 120px; /* íŒ¨ë”© ì¡°ì • */
        font-family: "Eagles-Bold", sans-serif;
        font-size: 1.8rem; /* í°íŠ¸ í¬ê¸° */
        transition: all 0.3s ease;
        background-color: #e0e0e0;
        color: #666;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .status-btn.updated {
        background-color: rgb(28, 30, 60);
        color: white;
        box-shadow: 0 4px 15px rgb(252, 78, 0);
      }

      .tomorrow-badge {
        background-color: #333;
        color: white;
        font-size: 1rem;
        padding: 5px 10px;
        border-radius: 50px;
        border: 1px solid rgb(28, 30, 60);
      }

      .weather-info {
        font-size: 1.1rem;
        color: #666;
        margin-top: 5px;
      }
      .weather-tag {
        background-color: #eee;
        padding: 3px 10px;
        border-radius: 4px;
        margin-right: 5px;
      }

      /* 4. í‘œ ìŠ¤íƒ€ì¼ - í™”ë©´ ë†’ì´ì— ë§ê²Œ ê°€ë³€ ì„¤ì • */
      #display {
        height: 90%; /* í™”ë©´ ë†’ì´ì˜ ì•½ 70%ë¥¼ í‘œê°€ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
        display: flex;
      }

      table {
        width: 100%;
        height: 100%; /* ë¶€ëª¨(#display) ë†’ì´ë¥¼ ê°€ë“ ì±„ì›€ */
        border-collapse: collapse;
        table-layout: fixed;
        background: white;
      }

      td {
        border: 1px solid #444;
        padding: 3px;
        text-align: center;
        font-size: 1.2rem;
        /* í•µì‹¬: í–‰ì´ ì ìœ¼ë©´ ë†’ì´ë¥¼ ëŠ˜ë¦¬ê³ , ë§ìœ¼ë©´ ì¤„ì–´ë“¤ê²Œ í•¨ */
        height: auto;
      }

      /* ì œëª© í–‰(íˆ¬ìˆ˜/ì•¼ìˆ˜)ì€ ë„ˆë¬´ ëŠ˜ì–´ë‚˜ì§€ ì•Šê²Œ ì ë‹¹í•œ ë†’ì´ ìœ ì§€ */
      .main-header {
        height: 37px;
        font-family: "Eagles-Bold", sans-serif;
        background-color: rgb(28, 30, 60);
        color: rgb(252, 78, 0);
        font-size: 2.1rem;
      }

      .col-time {
        background-color: rgb(235, 235, 235);
        font-weight: bold;
      }
      .col-content {
        text-align: left;
        padding-left: 20px;
      }
      .center-line {
        border-right: 3px solid #333 !important;
      }
      .player-list-cell {
        background-color: rgb(240, 240, 240);
        letter-spacing: 2px;
      }

      /* í•˜ë‹¨ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
      .bottom-link-container {
        display: flex;
        justify-content: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        margin-top: 40px; /* í‘œì™€ ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
        margin-bottom: 60px; /* í˜ì´ì§€ í•˜ë‹¨ ì—¬ë°± */
      }

      /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ (rionic14ë‹˜ì˜ ì„¤ì • ë°˜ì˜) */
      .futures-btn {
        text-decoration: none;
        color: #ffffff;
        background-color: rgb(252, 78, 0); /* ë”¥ ë„¤ì´ë¹„ */
        padding: 10px 300px;
        border-radius: 10px; /* ë” ë‘¥ê¸€ê²Œ */
        font-size: 1.6rem;
        font-family: "Eagles-Bold", sans-serif;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .futures-btn:hover {
        background-color: rgb(28, 30, 60); /* í•œí™” ì˜¤ë Œì§€ */
        transform: translateY(-3px); /* ì‚´ì§ ë– ì˜¤ë¥´ëŠ” íš¨ê³¼ */
        box-shadow: 0 6px 20px rgba(28, 30, 60, 0.3);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="uniform-container">
        <div class="uniform-title">ì°©ìš© ìœ ë‹ˆí¼</div>
        <img id="uniform-img" src="" alt="Today Uniform" />
      </div>

      <div class="schedule-header-container">
        <h1 class="main-title">
          <span id="date-text">SCHEDULE</span>
          <span id="badge-area"></span>
          <button id="update-btn" class="status-btn" onclick="toggleStatus()">
            âš ï¸ğŸš« ìŠ¤ì¼€ì¤„ ê°±ì‹  ì „ ğŸªğŸš§
          </button>
        </h1>
        <div id="weather-display" class="weather-info">
          ì„œì‚° ë‚ ì”¨ í™•ì¸ ì¤‘...
        </div>
      </div>

      <div id="display"></div>
    </div>
    <div id="display"></div>

    <div class="bottom-link-container">
      <a href="index.html" class="futures-btn"> í“¨ì²˜ìŠ¤ ìŠ¤ì¼€ì¤„ ë³´ê¸° â†’ </a>
    </div>

    <script>
      function toggleStatus() {
        const btn = document.getElementById("update-btn");
        btn.classList.toggle("updated");
        btn.innerText = btn.classList.contains("updated")
          ? "ë‚´ì¼ ìŠ¤ì¼€ì¤„ë¡œ ê°±ì‹  ì™„ë£Œ âœ…"
          : "ìŠ¤ì¼€ì¤„ ê°±ì‹  ì „ğŸš«";
      }

      // ë‚ ì”¨ ì‹¤í–‰, ì¤‘ê´„í˜¸ ê°¯ìˆ˜ ëŠ˜ë¦¬ë©´ ì—¬ëŸ¬êµ°ë° ë‚ ì”¨ ì•Œ ìˆ˜ ìˆë‹¤

      async function updateWeatherOnly() {
        const API_KEY = "cbdcecd908e8704e65f974ca31c52b4e";
        const cities = [
          { name: "ì„œì‚° ë‚®ê¸°ì˜¨ ì˜ˆìƒ", id: "Seosan,kr" },
          // { name: "ì²˜ê°€ì§‘ ë‚®ê¸°ì˜¨", id: "Kobe,jp" },  ë§ˆëˆ„ë¼ ì¼€ì´í•œí…Œ ë³´ì—¬ì¤„ë•Œ ì£¼ì„ í’€ ê²ƒ//
        ];
        const weatherDisplay = document.getElementById("weather-display");

        try {
          let html = "";
          for (let city of cities) {
            const response = await fetch(
              `https://api.openweathermap.org/data/2.5/forecast?q=${city.id}&appid=${API_KEY}&units=metric`,
            );
            const data = await response.json();

            const todayForecasts = data.list.slice(0, 8);
            const maxTemp = Math.round(
              Math.max(...todayForecasts.map((item) => item.main.temp_max)),
            );

            const icon = data.list[0].weather[0].icon;

            html += `
    <div class="weather-item" style="display: inline-block; margin-right: 15px; vertical-align: middle;">
        <span class="city-name" style="font-weight: bold;">${city.name}</span>
        <span class="max-temp" style="color: #ff6600; font-size: 1.3rem;">${maxTemp}Â°</span>
        
        <div style="
            display: inline-flex; 
            align-items: center; 
            justify-content: center;
            background-color: rgb(28, 150, 210); 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            margin-left: 5px; 
            vertical-align: middle;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        ">
            <img src="https://openweathermap.org/img/wn/${icon}@2x.png" 
                 style="width: 35px; height: 35px;">
        </div>
    </div>
`;
          }
          weatherDisplay.innerHTML = html;
        } catch (error) {
          console.error("ë‚ ì”¨ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", error);
        }
      }

      // í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì‹¤í–‰

      async function loadUniformImage(targetDate) {
        const imgElement = document.getElementById("uniform-img");
        try {
          const res = await fetch("uniforms/reserve-uniform.csv");
          const data = await res.text();
          const rows = data.trim().split("\n");
          const match = rows.find((row) => row.startsWith(targetDate));
          if (match) {
            const fileName = match.split(",")[1].trim();
            imgElement.src = `uniforms/${fileName}`;
            imgElement.style.display = "inline-block";
          }
        } catch (e) {
          console.error("Uniform CSV Error");
        }
      }

      async function run() {
        const now = new Date();
        const hours = now.getHours();
        let displayDate = new Date(now);
        let isTomorrow = false;

        if (hours >= 18) {
          displayDate.setDate(now.getDate() + 1);
          isTomorrow = true;
        }

        const dateStr = `${displayDate.getFullYear()}-${String(displayDate.getMonth() + 1).padStart(2, "0")}-${String(displayDate.getDate()).padStart(2, "0")}`;

        // ë‚ ì§œ ë° ë°°ì§€ í‘œì‹œ
        document.getElementById("date-text").innerText =
          `${dateStr} ìœ¡ì„±êµ° SCHEDULE`;
        if (isTomorrow) {
          document.getElementById("badge-area").innerHTML =
            `<span class="tomorrow-badge">TOMORROW</span>`;
        }

        // ë¹„ë™ê¸° ì‹¤í–‰ (í‘œ ë¡œë”© ë°©í•´ ì•ˆ í•¨)
        updateWeatherOnly();
        loadUniformImage(dateStr);

        // í‘œ ê·¸ë¦¬ê¸°
        try {
          const res = await fetch("reserve.csv");
          const csvData = await res.text();
          const rows = csvData.trim().split("\n");
          let html = `<table><colgroup><col style="width: 8%;"><col style="width: 42%;"><col style="width: 8%;"><col style="width: 42%;"></colgroup>`;

          rows.forEach((row, index) => {
            const cols = row.split(",");
            html += "<tr>";
            if (index === 0) {
              html += `<td colspan="2" class="main-header center-line">${cols[0] || "íˆ¬ìˆ˜"}</td>`;
              html += `<td colspan="2" class="main-header">${cols[2] || "ì•¼ìˆ˜"}</td>`;
            } else if (index === rows.length - 1) {
              html += `<td class="col-time">${cols[0] || "ê¸°íƒ€"}</td>`;
              html += `<td colspan="3" class="col-content">${cols[1] || ""}</td>`;
            } else {
              cols.forEach((col, colIndex) => {
                const isPlayerList = col.includes("ì„ ìˆ˜ëª…ë‹¨");
                let cellClass = isPlayerList
                  ? "player-list-cell"
                  : colIndex % 2 === 0
                    ? "col-time"
                    : "col-content";
                html += `<td class="${cellClass} ${colIndex === 1 ? "center-line" : ""}">${col || ""}</td>`;
              });
            }
            html += "</tr>";
          });
          html += "</table>";
          document.getElementById("display").innerHTML = html;
        } catch (e) {
          document.getElementById("display").innerHTML =
            "<p>CSV íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
        }
      }

      run();
    </script>
  </body>
</html>
